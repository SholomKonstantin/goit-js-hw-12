{"version":3,"file":"commonHelpers.js","sources":["../src/img/alert.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__0a4fe6ce__\"","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport alertImg from \"/img/alert.svg\";\nimport axios from \"axios\";\n\nconst form = document.querySelector('.form');\nconst getMoreBtn = document.querySelector(\".get-more-btn\");\n\nconst photoLoader = {\n    url: \"https://pixabay.com/api/\",\n    searchParams: {\n        key: \"42136194-d83aa60221700b9cbb1b7b2b9\",\n        q: \"\",\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n        page: 1,\n    },\n    prevSearchTerm: \"\",\n    searchPhotosBtn: document.querySelector(\".search-btn\"),\n    searchTerm: document.querySelector(\".searchTerm\"),\n    loader: document.querySelector(\".loader\"),\n    gallery: document.querySelector(\".gallery\"),\n    totalHits: 0,\n\n    simpleGallery: new SimpleLightbox(\".gallery a\", {\n        overlayOpacity: 0.8,\n        captionsData: 'alt',\n        captionDelay: 250,\n    }),\n\n    startSearch(event) {\n        event.preventDefault();\n        const newSearchTerm = this.searchTerm.value.trim();\n        if (newSearchTerm.length < 3) {\n            this.showAlert(\"Please, enter search term!\");\n            return;\n        }\n        if (newSearchTerm === this.prevSearchTerm) {\n            this.showAlert(\"You have already searched for this term.\");\n            return;\n        }\n        this.prevSearchTerm = newSearchTerm;\n        this.gallery.innerHTML = '';\n        this.searchParams.q = newSearchTerm;\n        this.searchParams.page = 1;\n        this.fetchPhotos();\n    },\n\n    loadMorePhotos() {\n        this.searchParams.page += 1;\n        this.fetchPhotos();\n    },\n\n    renderPhotos(photos) {\n        if (photos.total === 0) {\n            this.showAlert('Sorry, there are no images matching your search query. Please try again!');\n            this.showLoaderAndButtons(false);\n            getMoreBtn.style.display = 'none';  // Скрыть кнопку при отсутствии изображений\n            return;\n        }\n        this.totalHits = photos.totalHits;\n        const markup = photos.hits\n            .map((photo) => {\n                return `<a class=\"gallery-link\" href=\"${photo.largeImageURL}\">\n                <span class=\"gallery-item\"><img class=\"gallery-image\" src=\"${photo.webformatURL}\" alt=\"${photo.tags}\" title=\"${photo.tags}\" /></span>\n                <span class=\"img-stat\">\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Likes</span><span class=\"img-stat-val\">${photo.likes}</span></span>\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Views</span><span class=\"img-stat-val\">${photo.views}</span></span>\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Comments</span><span class=\"img-stat-val\">${photo.comments}</span></span>\n                <span class=\"img-stat-item\"><span class=\"img-stat-title\">Downloads</span><span class=\"img-stat-val\">${photo.downloads}</span></span>\n                </span>\n                </a>`;\n            })\n            .join(\"\");\n        this.gallery.insertAdjacentHTML(\"beforeend\", markup);\n        this.simpleGallery.refresh();\n        this.scrollTop();\n    },\n\n    scrollTop() {\n        if (this.searchParams.page > 1) {\n            const firstGalleryLink = document.querySelector(\".gallery-link\");\n            if (firstGalleryLink) {\n                const rect = firstGalleryLink.getBoundingClientRect();\n                window.scrollBy({ top: rect.height * 2, left: 0, behavior: \"smooth\" });\n            }\n        }\n    },\n\n    showLoaderAndButtons(state = true) {\n        this.loader.style.display = !state ? 'none' : 'inline-block';\n        getMoreBtn.style.display = !state ? 'block' : 'none';\n        this.searchPhotosBtn.disabled = state;\n        if (state === false) {\n            if (this.searchParams.page === 1 && this.totalHits > 1) {\n                getMoreBtn.style.display = 'block';\n            }\n            if (Math.ceil(this.totalHits / this.searchParams.per_page) === this.searchParams.page) {\n                getMoreBtn.style.display = 'none';\n                this.showAlert(\"We're sorry, but you've reached the end of search results.\");\n            }\n        }\n    },\n\n    showAlert(msg) {\n        iziToast.show({\n            position: 'center',\n            iconUrl: alertImg,\n            messageColor: '#FAFAFB',\n            messageSize: '16px',\n            backgroundColor: '#EF4040',\n            close: false,\n            closeOnClick: true,\n            message: msg\n        })\n    },\n\n    async fetchPhotos() {\n        this.showLoaderAndButtons();\n        try {\n            const response = await axios.get(this.url, { params: this.searchParams });\n            this.renderPhotos(response.data);\n        } catch (error) {\n            this.showAlert(error.message);\n        }\n        this.showLoaderAndButtons(false);\n    }\n}\n\nform.addEventListener(\"submit\", (event) => photoLoader.startSearch(event));\n\ngetMoreBtn.addEventListener(\"click\", () => photoLoader.loadMorePhotos());\n"],"names":["alertImg","form","getMoreBtn","photoLoader","SimpleLightbox","event","newSearchTerm","photos","markup","photo","firstGalleryLink","rect","state","msg","iziToast","response","axios","error"],"mappings":"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"}